<h1> Flights Index Page</h1>

<hr>
<% if user_signed_in? %>

  <% @flights['trips']['tripOption'].each do |flight| %>


  <!-- #code to not divide by zero -->
    <% if (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) != 0  %>

      <!-- #check ratio -->
      <% if (flight['slice'][0]['segment'][0]['leg'][0]['mileage'].to_i) / (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) > 8  %>
        <div class="flight-div">
          <!-- This returns the final destination, if trips have a stop -->
        Final Destination =  <%= flight['slice'][0]['segment'].last['leg'][0]['destination'] %>
          <br>
        Number of stops =  <%= flight['slice'][0]['segment'].length - 1 %>
          <br>
        
          <%# flight['slice'][0]['segment'].each do |segment| %>
            <!-- Destination(not accurate if multiple stops)-   -->
            <%# segment['leg'][0]['destination'] %>
            <!-- <br> -->
          <%# end %>

            Incorrect Destionation(first stop): <%= flight['slice'][0]['segment'][0]['leg'][0]['destination'] %>
          <br>
          Total Travel Time: <%= flight['slice'][0]['duration'] %> - Minutes
          <br>
          Airline Carrier <%= flight['slice'][0]['segment'][0]['flight']['carrier'] %>
          <br>
          Airline Number <%= flight['slice'][0]['segment'][0]['flight']['number'] %>
          <br>
          Price: <%= flight['saleTotal'] %>
          <br>
          Mileage: <%= flight['slice'][0]['segment'][0]['leg'][0]['mileage'] %>
          <br>
          Arrival Time: <%= flight['slice'][0]['segment'][0]['leg'][0]['arrivalTime'] %>
          <br>
          Departure Time: <%= flight['slice'][0]['segment'][0]['leg'][0]['departureTime'] %>
          <br>
          Miles Per Dollar (mp$) =  <%= (flight['slice'][0]['segment'][0]['leg'][0]['mileage'].to_i) / (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) %> mp$
          <br>
          This is a great deal!!
          <br>
          <hr>

       </div>
        <%# elsif (flight['slice'][0]['segment'][0]['leg'][0]['mileage'].to_i) / (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) > 8 %>
        <!-- Miles Per Dollar (mp$) =  <%= (flight['slice'][0]['segment'][0]['leg'][0]['mileage'].to_i) / (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) %> mp$ -->
        <!-- <br> -->
        <!-- This is a decent deal -->
        <!-- <br> -->
      <%# else %>
        <!-- Miles Per Dollar (mp$) =  <%= (flight['slice'][0]['segment'][0]['leg'][0]['mileage'].to_i) / (flight['saleTotal'].gsub(/[^\d\.-]/,'').to_i) %> mp$ -->
        <!-- <br> -->
        <!-- This is a bad deal -->
        <!-- <br> -->
      <% end %>

    <% else %>
      mileage is 0 and you cannot get price per mile because you cannot divide by 0
    <% end %>
     <br>

  <% end %>
  <% else %>
  <h1>Please Sign in to view fligts</h1>
<% end %>
